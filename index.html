<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Chaos Game Web</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      padding: 30px 20px;
      background-color: #0f0f0f;
      color: #f0f0f0;
      font-family: 'Press Start 2P', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    h1 {
      font-size: 1rem;
      text-align: center;
      margin-bottom: 10px;
    }

    nav.breadcrumb {
      width: 100%;
      margin-bottom: 20px;
      text-align: left;
    }

    nav.breadcrumb a {
      color: #00ffff;
      text-decoration: none;
      font-size: 0.7rem;
    }

    nav.breadcrumb a:hover {
      text-decoration: underline;
    }

    #controls {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-bottom: 20px;
      background-color: #1a1a1a;
      padding: 15px;
      border: 1px solid #444;
      border-radius: 8px;
      width: 100%;
      max-width: 700px;
    }

    label {
      font-size: 0.5rem;
      display: flex;
      flex-direction: column;
      color: #ccc;
    }

    input, select, button {
      margin-top: 5px;
      font-family: 'Press Start 2P', sans-serif;
      font-size: 0.6rem;
      padding: 6px;
      background-color: #222;
      color: #00ffff;
      border: 1px solid #444;
      border-radius: 4px;
    }

    button:hover {
      background-color: #333;
      cursor: pointer;
    }

    canvas {
      border: 2px solid #333;
      background-color: black;
      margin-top: 20px;
      max-width: 100%;
    }

    @media (max-width: 600px) {
      #controls {
        flex-direction: column;
        align-items: center;
      }
    }
  </style>
</head>
<body>

<nav class="breadcrumb">
  <a href="index.html">← Back to Home</a>
</nav>

<h1>Chaos Game in the Browser</h1>

<div id="controls">
  <label>Corners (3+):
    <input type="number" id="corners" value="3" min="3" max="10">
  </label>
  <label>Step (0.1–2.0):
    <input type="number" id="step" value="1.5" step="0.1" min="0.1" max="2">
  </label>
  <label>Iterations:
    <input type="number" id="iterations" value="5000" min="100" max="100000" step="100">
  </label>
  <label>Color:
    <input type="color" id="color" value="#00ffff">
  </label>
  <button id="startBtn">Start</button>
  <button id="resetBtn">Reset</button>
  <button id="saveBtn">Save</button>
</div>

<canvas id="canvas" width="600" height="600"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

function generatePolygon(n, radius = 250, centerX = canvas.width / 2, centerY = canvas.height / 2) {
  const vertices = [];
  for (let i = 0; i < n; i++) {
    const angle = 2 * Math.PI * i / n;
    vertices.push({
      x: centerX + radius * Math.cos(angle),
      y: centerY + radius * Math.sin(angle)
    });
  }
  return vertices;
}

let animationFrame;
let running = false;

function startChaosGameAnimated(numVertices, iterations, step, color) {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  const vertices = generatePolygon(numVertices);
  let x = Math.random() * canvas.width;
  let y = Math.random() * canvas.height;
  let i = 0;

  ctx.fillStyle = color;
  running = true;

  function draw() {
    if (!running || i >= iterations) return;

    for (let j = 0; j < 100 && i < iterations; j++, i++) {
      const v = vertices[Math.floor(Math.random() * vertices.length)];
      x = x + step * (v.x - x);
      y = y + step * (v.y - y);
      ctx.fillRect(x, y, 2, 2);
    }

    animationFrame = requestAnimationFrame(draw);
  }

  draw();
}

document.getElementById('startBtn').addEventListener('click', () => {
  const numVertices = parseInt(document.getElementById('corners').value);
  const step = parseFloat(document.getElementById('step').value);
  const iterations = parseInt(document.getElementById('iterations').value);
  const color = document.getElementById('color').value;

  if (numVertices < 3 || step <= 0 || iterations < 100) {
    alert("Please enter valid parameters.");
    return;
  }

  running = false;
  cancelAnimationFrame(animationFrame);
  startChaosGameAnimated(numVertices, iterations, step, color);
});

document.getElementById('resetBtn').addEventListener('click', () => {
  running = false;
  cancelAnimationFrame(animationFrame);
  ctx.clearRect(0, 0, canvas.width, canvas.height);
});

document.getElementById('saveBtn').addEventListener('click', () => {
  const link = document.createElement('a');
  link.download = 'chaosgame.png';
  link.href = canvas.toDataURL('image/png');
  link.click();
});
</script>

</body>
</html>

